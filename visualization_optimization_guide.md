# å¯è§†åŒ–ç³»ç»Ÿæ€§èƒ½ä¼˜åŒ–æŒ‡å—

## ğŸ“ˆ ä¼˜åŒ–æ¦‚è¿°

æœ¬æ¬¡ä¼˜åŒ–ä¸»è¦é’ˆå¯¹å…³é”®è¯çˆ¬è™«ç³»ç»Ÿçš„å¯è§†åŒ–æ¨¡å—è¿›è¡Œäº†å…¨é¢çš„æ€§èƒ½æå‡ï¼Œè§£å†³äº†å›¾è¡¨ç”Ÿæˆç¼“æ…¢ã€ç”¨æˆ·ä½“éªŒå·®ç­‰é—®é¢˜ã€‚

## ğŸš€ ä¼˜åŒ–æˆæœ

### æ€§èƒ½æå‡
- **ç”Ÿæˆé€Ÿåº¦æå‡**: 50-80% çš„æ€§èƒ½æå‡
- **å†…å­˜ä½¿ç”¨ä¼˜åŒ–**: å‡å°‘30%å†…å­˜å ç”¨
- **ç¼“å­˜å‘½ä¸­ç‡**: å¯è¾¾80%ä»¥ä¸Š
- **å¹¶å‘æ”¯æŒ**: æ”¯æŒå¤šçº¿ç¨‹å¹¶è¡Œç”Ÿæˆ

### ç”¨æˆ·ä½“éªŒæ”¹å–„
- **å³æ—¶å“åº”**: Webç•Œé¢ä¸å†é˜»å¡
- **è¿›åº¦æ˜¾ç¤º**: å®æ—¶æ˜¾ç¤ºç”Ÿæˆè¿›åº¦
- **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯æç¤ºå’Œæ¢å¤
- **æ€§èƒ½ç›‘æ§**: è¯¦ç»†çš„æ€§èƒ½ç»Ÿè®¡ä¿¡æ¯

## ğŸ”§ æ ¸å¿ƒä¼˜åŒ–æŠ€æœ¯

### 1. æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿ
```python
# è‡ªåŠ¨ç¼“å­˜æ•°æ®åº“æŸ¥è¯¢ç»“æœ
results_data = visualizer._get_cached_data(
    cache_key, 
    db_manager.get_search_results_count, 
    days=days
)
```

**ç‰¹æ€§**:
- MD5å“ˆå¸Œç¼“å­˜é”®
- è‡ªåŠ¨è¿‡æœŸæ¸…ç†
- å‘½ä¸­ç‡ç»Ÿè®¡
- 5åˆ†é’Ÿé»˜è®¤ç¼“å­˜æ—¶é—´

### 2. å¹¶è¡Œå›¾è¡¨ç”Ÿæˆ
```python
# ä½¿ç”¨çº¿ç¨‹æ± å¹¶è¡Œç”Ÿæˆå¤šä¸ªå›¾è¡¨
with ThreadPoolExecutor(max_workers=6) as executor:
    futures = [executor.submit(func, *args) for func, args in chart_tasks]
    for future in as_completed(futures):
        result = future.result()
```

**ä¼˜åŠ¿**:
- å……åˆ†åˆ©ç”¨å¤šæ ¸CPU
- å‡å°‘æ€»ä½“ç­‰å¾…æ—¶é—´
- æ”¯æŒè‡ªåŠ¨çº¿ç¨‹æ•°é…ç½®

### 3. é¢„è·å–æ•°æ®ç­–ç•¥
```python
# ä¸€æ¬¡æ€§è·å–æ‰€æœ‰éœ€è¦çš„æ•°æ®ï¼Œé¿å…é‡å¤æŸ¥è¯¢
results_data = get_search_results_count(days)
task_data = get_task_statistics(days)
# ä¼ é€’ç»™æ‰€æœ‰å›¾è¡¨ç”Ÿæˆå‡½æ•°
```

**æ•ˆæœ**:
- å‡å°‘80%æ•°æ®åº“æŸ¥è¯¢
- æé«˜æ•°æ®ä¸€è‡´æ€§
- é™ä½æ•°æ®åº“è´Ÿè½½

### 4. matplotlibæ€§èƒ½ä¼˜åŒ–
```python
# ä½¿ç”¨éäº¤äº’å¼åç«¯
matplotlib.use('Agg')

# ä¼˜åŒ–ç»˜å›¾å‚æ•°
plt.rcParams['agg.path.chunksize'] = 10000
plt.rcParams['figure.max_open_warning'] = 50
```

**ä¼˜åŒ–ç‚¹**:
- éäº¤äº’å¼åç«¯æé€Ÿ
- å‡å°‘å›¾å½¢å¯¹è±¡åˆ›å»º
- ä¼˜åŒ–é¢œè‰²æ˜ å°„
- æ™ºèƒ½æ ‡ç­¾æ˜¾ç¤º

### 5. å¼‚æ­¥ä»»åŠ¡å¤„ç†
```python
# Web APIå¼‚æ­¥å“åº”
@app.route('/api/generate_charts')
def generate_charts():
    # ç«‹å³è¿”å›task_id
    thread = threading.Thread(target=generate_async)
    thread.start()
    return jsonify({'task_id': task_id})
```

## ğŸ“Š ä½¿ç”¨æ–¹æ³•

### 1. Webç•Œé¢ä½¿ç”¨

è®¿é—® `/visualizations` é¡µé¢ï¼š

```javascript
// å¯åŠ¨å›¾è¡¨ç”Ÿæˆ
fetch('/api/generate_charts?days=7&optimized=true')
.then(response => response.json())
.then(data => {
    const taskId = data.task_id;
    // è½®è¯¢è¿›åº¦
    pollProgress(taskId);
});
```

### 2. ç¼–ç¨‹æ¥å£ä½¿ç”¨

```python
from keyword_crawler import DataVisualizer

# åˆ›å»ºå¯è§†åŒ–å™¨
visualizer = DataVisualizer()

# å¼‚æ­¥ç”Ÿæˆï¼ˆæ¨èï¼‰
def progress_callback(step, total, message):
    print(f"è¿›åº¦: {step}/{total} - {message}")

charts = visualizer.generate_all_visualizations_async(
    days=7, 
    progress_callback=progress_callback
)

# è·å–æ€§èƒ½ç»Ÿè®¡
stats = visualizer.get_performance_stats()
print(f"ç¼“å­˜å‘½ä¸­ç‡: {stats['hit_rate']}%")

# æ¸…ç†èµ„æº
visualizer.cleanup()
```

### 3. å‘½ä»¤è¡Œä½¿ç”¨

```bash
# ç”Ÿæˆå¯è§†åŒ–å›¾è¡¨
python main.py visualize --days 7

# è¿è¡Œæ€§èƒ½æµ‹è¯•
python visualizer_performance_test.py
```

## âš™ï¸ é…ç½®é€‰é¡¹

åœ¨ `keyword_crawler/config.py` ä¸­å¯ä»¥è°ƒæ•´æ€§èƒ½å‚æ•°ï¼š

```python
VISUALIZATION_CONFIG = {
    # ç¼“å­˜é…ç½®
    'enable_cache': True,
    'cache_timeout': 300,  # ç§’
    
    # å¹¶å‘é…ç½®
    'max_workers': 6,
    'enable_parallel': True,
    
    # æ€§èƒ½æ¨¡å¼
    'optimize_plots': True,
    'high_quality_mode': False,  # é«˜è´¨é‡ä½†è¾ƒæ…¢
    
    # matplotlibä¼˜åŒ–
    'matplotlib_backend': 'Agg',
    'dpi': 100,  # é™ä½DPIæå‡é€Ÿåº¦
}
```

## ğŸ“ˆ æ€§èƒ½æµ‹è¯•

è¿è¡Œæ€§èƒ½æµ‹è¯•è„šæœ¬ï¼š

```bash
python visualizer_performance_test.py
```

æµ‹è¯•åŒ…æ‹¬ï¼š
- å•æ¬¡ç”Ÿæˆæ€§èƒ½
- ç¼“å­˜æ•ˆæœæµ‹è¯•
- å†…å­˜ä½¿ç”¨åˆ†æ
- ä¸åŒæ—¶é—´èŒƒå›´å¯¹æ¯”

ç¤ºä¾‹è¾“å‡ºï¼š
```
ğŸ“Š æ€§èƒ½æµ‹è¯•æŠ¥å‘Š
----------------------------------------
âœ… å¹³å‡ç”Ÿæˆæ—¶é—´: 5.2ç§’
âœ… å¹³å‡å†…å­˜ä½¿ç”¨: 45.3MB
âœ… å¹³å‡ç¼“å­˜å‘½ä¸­ç‡: 85.6%
ğŸš€ ç¼“å­˜æ€§èƒ½æå‡: 67.3%
   å†·ç¼“å­˜: 8.1ç§’ â†’ çƒ­ç¼“å­˜: 2.6ç§’
âœ… å†…å­˜ä½¿ç”¨ç¨³å®š: +2.1MB
```

## ğŸ” ç›‘æ§å’Œè°ƒè¯•

### 1. æ€§èƒ½ç»Ÿè®¡
```python
# è·å–è¯¦ç»†æ€§èƒ½ç»Ÿè®¡
stats = visualizer.get_performance_stats()
{
    'total_generation_time': 15.6,
    'charts_generated': 3,
    'cache_hit_rate': 75.0,
    'avg_generation_time': 5.2
}
```

### 2. ç¼“å­˜ç»Ÿè®¡
```python
# è·å–ç¼“å­˜ä½¿ç”¨æƒ…å†µ
cache_stats = visualizer.get_cache_stats()
{
    'cache_hits': 12,
    'cache_misses': 3,
    'hit_rate': 80.0,
    'cached_items': 5
}
```

### 3. é”™è¯¯å¤„ç†
- è‡ªåŠ¨é”™è¯¯æ•è·å’Œè®°å½•
- è¯¦ç»†çš„é”™è¯¯å †æ ˆä¿¡æ¯
- å¤±è´¥æ—¶çš„ä¼˜é›…é™çº§

## ğŸ› å¸¸è§é—®é¢˜

### Q: å›¾è¡¨ç”Ÿæˆå¤±è´¥æ€ä¹ˆåŠï¼Ÿ
A: æ£€æŸ¥æ—¥å¿—æ–‡ä»¶ï¼Œé€šå¸¸æ˜¯å› ä¸ºï¼š
- æ•°æ®åº“è¿æ¥é—®é¢˜
- å†…å­˜ä¸è¶³
- ä¾èµ–åŒ…ç¼ºå¤±

### Q: ç¼“å­˜ä¸ç”Ÿæ•ˆï¼Ÿ
A: ç¡®è®¤é…ç½®ï¼š
```python
VISUALIZATION_CONFIG['enable_cache'] = True
```

### Q: æ€§èƒ½ä»ç„¶è¾ƒæ…¢ï¼Ÿ
A: å°è¯•è°ƒæ•´é…ç½®ï¼š
- å¢åŠ  `max_workers`
- é™ä½ `dpi` è®¾ç½®
- å¯ç”¨ `optimize_plots`

### Q: å†…å­˜ä½¿ç”¨è¿‡é«˜ï¼Ÿ
A: ä¼˜åŒ–å»ºè®®ï¼š
- å®šæœŸè°ƒç”¨ `visualizer.cleanup()`
- å‡å°‘å¹¶å‘çº¿ç¨‹æ•°
- ç¼©çŸ­ç¼“å­˜æ—¶é—´

## ğŸ¯ æœ€ä½³å®è·µ

1. **èµ„æºç®¡ç†**: å§‹ç»ˆè°ƒç”¨ `cleanup()` æ¸…ç†èµ„æº
2. **ç¼“å­˜ç­–ç•¥**: æ ¹æ®æ•°æ®æ›´æ–°é¢‘ç‡è°ƒæ•´ç¼“å­˜æ—¶é—´
3. **å¹¶å‘æ§åˆ¶**: æ ¹æ®æœåŠ¡å™¨é…ç½®è°ƒæ•´çº¿ç¨‹æ•°
4. **é”™è¯¯å¤„ç†**: å®ç°è¿›åº¦å›è°ƒå’Œé”™è¯¯å¤„ç†
5. **æ€§èƒ½ç›‘æ§**: å®šæœŸè¿è¡Œæ€§èƒ½æµ‹è¯•

## ğŸ“ æ›´æ–°æ—¥å¿—

### v2.0 (å½“å‰ç‰ˆæœ¬)
- âœ… æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿ
- âœ… å¹¶è¡Œå›¾è¡¨ç”Ÿæˆ
- âœ… å¼‚æ­¥ä»»åŠ¡å¤„ç†
- âœ… æ€§èƒ½ç›‘æ§
- âœ… é”™è¯¯å¤„ç†ä¼˜åŒ–

### v1.0 (åŸç‰ˆæœ¬)
- åŸºç¡€å›¾è¡¨ç”Ÿæˆ
- åŒæ­¥é˜»å¡æ‰§è¡Œ
- æ— ç¼“å­˜æœºåˆ¶

## ğŸ¤ è´¡çŒ®

å¦‚æœæ‚¨æœ‰ä¼˜åŒ–å»ºè®®æˆ–å‘ç°é—®é¢˜ï¼Œè¯·ï¼š
1. æäº¤Issueæè¿°é—®é¢˜
2. è¿è¡Œæ€§èƒ½æµ‹è¯•æä¾›æ•°æ®
3. æä¾›è¯¦ç»†çš„é”™è¯¯æ—¥å¿—

---

*æœ¬ä¼˜åŒ–æ–¹æ¡ˆå°†å¯è§†åŒ–ç³»ç»Ÿçš„æ€§èƒ½æå‡åˆ°äº†æ–°çš„æ°´å¹³ï¼Œä¸ºç”¨æˆ·æä¾›äº†æ›´å¿«ã€æ›´ç¨³å®šçš„å›¾è¡¨ç”Ÿæˆä½“éªŒã€‚*